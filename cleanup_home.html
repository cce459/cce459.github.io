<!DOCTYPE html>
<html>
<head>
    <title>Home Data Cleanup</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>정리 도구</h1>
    <button onclick="cleanupHomeData()">Home 데이터 정리</button>
    <button onclick="showCurrentData()">현재 데이터 확인</button>
    <div id="output" style="margin-top: 20px; white-space: pre-wrap; font-family: monospace;"></div>
    
    <script>
        function cleanupHomeData() {
            try {
                // Get existing data
                const pages = JSON.parse(localStorage.getItem('wiki-pages') || '{}');
                const recent = JSON.parse(localStorage.getItem('wiki-recent') || '[]');
                const history = JSON.parse(localStorage.getItem('wiki-history') || '{}');
                
                let output = '=== Home 데이터 정리 시작 ===\n';
                
                // Remove Home page if it exists
                if (pages['Home']) {
                    delete pages['Home'];
                    output += '✓ Home 페이지 삭제됨\n';
                } else {
                    output += '• Home 페이지 없음\n';
                }
                
                // Remove Home from recent list
                const originalRecentLength = recent.length;
                const updatedRecent = recent.filter(item => item !== 'Home');
                if (originalRecentLength !== updatedRecent.length) {
                    output += '✓ 최근 목록에서 Home 제거됨\n';
                } else {
                    output += '• 최근 목록에 Home 없음\n';
                }
                
                // Remove Home from history
                if (history['Home']) {
                    delete history['Home'];
                    output += '✓ Home 히스토리 삭제됨\n';
                } else {
                    output += '• Home 히스토리 없음\n';
                }
                
                // Update localStorage
                localStorage.setItem('wiki-pages', JSON.stringify(pages));
                localStorage.setItem('wiki-recent', JSON.stringify(updatedRecent));
                localStorage.setItem('wiki-history', JSON.stringify(history));
                
                output += '\n=== 정리 완료 ===\n';
                output += '현재 페이지: ' + Object.keys(pages).join(', ') + '\n';
                output += '최근 목록: ' + updatedRecent.join(', ') + '\n';
                
                document.getElementById('output').textContent = output;
                
                // Reload the main page after cleanup
                setTimeout(() => {
                    if (confirm('정리가 완료되었습니다. 메인 페이지로 돌아가시겠습니까?')) {
                        window.location.href = '/';
                    }
                }, 1000);
                
            } catch (error) {
                document.getElementById('output').textContent = '오류 발생: ' + error.message;
            }
        }
        
        function showCurrentData() {
            try {
                const pages = JSON.parse(localStorage.getItem('wiki-pages') || '{}');
                const recent = JSON.parse(localStorage.getItem('wiki-recent') || '[]');
                
                let output = '=== 현재 저장된 데이터 ===\n';
                output += '페이지 목록: ' + Object.keys(pages).join(', ') + '\n';
                output += '최근 편집: ' + recent.join(', ') + '\n';
                output += '\n페이지 상세:\n';
                
                for (const [title, page] of Object.entries(pages)) {
                    output += `- ${title}: ${page.content.substring(0, 50)}...\n`;
                }
                
                document.getElementById('output').textContent = output;
            } catch (error) {
                document.getElementById('output').textContent = '오류 발생: ' + error.message;
            }
        }
    </script>
</body>
</html>